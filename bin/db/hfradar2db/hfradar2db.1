.TH HFRADAR2DB 1 "$Date: 2007/06/13 23:05:43 $"
.SH NAME
hfradar2db \- store HFRADAR files in a database
.SH SYNOPSIS
.nf
hfradar2db [-n net] [-s sta] [-b patterntype] [-t time] [-o] [-v] [-p pfname] dbname filename 
.fi
.SH DESCRIPTION
This program is a companion to \fBhfradar2orb\fP, allowing the user to store 
HFRADAR files in a Datascope database directly rather than through the 
automated system. 

\fBhfradar2db\fP takes the name of one or more files on the command line
and puts them in the database according to dfiles_pattern, format, and table 
names specified in the parameter file. The 
net, sta, patterntype, and time values for the file may be specified explicitly 
on the command line, or extracted from the filenames via regular-expressions defined
in the parameter file (the command-line options take precedence over the parameter
file). The parameter-file entries for these four fields should be string-literals
(see pf(5)) which contain pieces of perl code. The perl code pieces expect the 
perl variable $dfile to be already defined. They should use this value to set 
the variables $net, $site, $patterntype , and $timestamp, respectively (the names 
are slightly different than the field names, i.e. site instead of sta, timestamp
instead of time, for historical compatibility with hfradar2orb). 

The time argument may be a Unix epoch time, or any time-string interpretable 
by the str2epoch(3) command (although if a time string is used it should 
be enclosed in single quotes to prevent interpretation by the shell). 
.SH OPTIONS
.IP "-n net" 
Specify the network name for ingested files. 
If this option is not given, 
the network name is derived from the input filename using the perl code
in the \fInet\fP field of the parameter file. 
.IP "-s sta" 
Specify the station name for ingested files. If this option is not given, 
the station name is derived from the input filename using the perl code
in the \fIsite\fP field of the parameter file. 
.IP "-b patterntype" 
Specify the patterntype code for the beampattern of the ingested files. 
If this option is not given, the patterntype is derived from the input 
filename using the perl code
in the \fIpatterntype\fP field of the parameter file. 
.IP "-t timestamp" 
Specify the timestamp to record for the ingested files. If this option is not given, 
the timestamp is derived from the input filename using the perl code
in the \fItimestamp\fP field of the parameter file. 
.IP -o
Overwrite files. If this is not specified, \fBhfradar2db\fP will not overwrite 
existing radialfiles of the same name in the database.
.IP "-p pfname" 
Specify a parameter file other than the default \fBhfradar2db\fP.pf
.IP -v
Verbose
.SH FILES
.SH ENVIRONMENT
.SH PARAMETER FILE
.nf

dfiles_pattern Radials/%{net}/%{sta}/Rads_%Y-%m/Rad_%{patterntype}_%{net}_%{sta}_%y-%m-%d_%H%M.%{format}
format hfrss10lluv
table radialfiles

site	&Literal{
	$site = ($dfile =~ /^Rad_[isz]_[a-zA-Z0-9]+_([a-zA-Z0-9]+)[_\s]/)[0];
	$site = uc( $site );
}

net	&Literal{
	$net = ($dfile =~ /^Rad_[isz]_([a-zA-Z0-9]+)/)[0];
	$net = uc( $net );
}

timestamp	&Literal{
	@mdyhms =
	  (($dfile =~ /(\d\d)[-_](\d\d)[-_](\d\d)[-_\s](\d\d)(\d\d)/)[1,2,0,3,4],0);
	$timestamp = str2epoch( sprintf( "%s/%s/%s %s:%s:%s", @mdyhms ) );
}

patterntype	&Literal{
	$patterntype = ($dfile =~ /^Rad_([isz])/)[0];
}

.fi
.SH EXAMPLE
.in 2c
.ft CW
.nf

% hfradar2db -o -v mydb ./Rad*
hfradar2db: orbhfradar2db starting at  6/13/2007  20:28:27.208 (orbhfradar2db $Revision: 1.3 $Date: 2007/06/13 01:53:04 )
hfradar2db: Creating /scr/month/dbhfrtest/Radials/ODU/CBBT/Rads_2007-03/Rad_i_ODU_CBBT_07-03-26_1200.hfrss10lluv
hfradar2db: Adding site row for ODU_CBBT
hfradar2db: Creating /scr/month/dbhfrtest/Radials/SIO/SDSC/Rads_2007-06/Rad_i_SIO_SDSC_07-06-13_1300.hfrss10lluv
hfradar2db: Adding site row for SIO_SDSC
% 

.fi
.ft R
.in
.SH RETURN VALUES
.SH LIBRARY
.SH ATTRIBUTES
.SH DIAGNOSTICS
.SH "SEE ALSO"
.nf
orbhfradar2db(1), hfradartools(3P), codartools(3P)
.fi
.SH "BUGS AND CAVEATS"
.SH AUTHOR
.nf
Kent Lindquist 
Lindquist Consulting, Inc. 
.fi
.\" $Id: hfradar2db.1,v 1.3 2007/06/13 23:05:43 lindquis Exp $
