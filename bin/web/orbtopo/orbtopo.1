.TH ORBTOPO 1 "$Date: 2004/08/20 20:04:19 $"
.SH NAME
map_changes, orbtopo_db, orbtopo.cgi \- a collection of
applications to analyze current topology as well as changes,
this software is focused on web and email accessible interfaces
.SH SYNOPSIS
.nf
map_changes [-V] [-v] [-o orbname] [-m match] [-r reject]
    [-t latencytimeout] [-i mapinterval] [-l maplocation]
    [-d tmpfiledir] [-s emailsubject] [-n nailpath]
    [-g graphvizpath] [-c checkinterval] -x "emailaddr(s)"

orbtopo_db [-V] [-w timewindow] [-o orbname]

orbtopo.cgi
.fi
.SH DESCRIPTION
map_changes is a command line utility that creates two temporary
files in /tmp (most_recent.dot, srcoutage.dat). 
These files are created with the aid of orbtopo_db. map_changes
runs continously and every 30 minutes (-c option) it checks for topology
changes or data sources that have not been updated recently.  If either
occurs it sends an email listing the culprits.  It depends on the following
applications:  graphviz and nail to do its dirty work.

orbtopo.cgi uses graphviz and a registry1.0 schema to generate a
topology image in gif format.  This program is run as a cgi script and
generates the topology on the fly. orbtopo_detail.cgi is a secondary web
script refered to by orbtopo.cgi. Pathnames for the registry database, 
the web output files, and the path to the dot command are specified in
the orbtopo.pf parameter file. orbtopo explicitly sets the PFPATH 
environment variable within the script to be 
.nf

	$ANTELOPE/data/pf:.

.fi
.SH OPTIONS
.nf
.IP -V				
print usage and exit
.IP -v				
verbose
.IP "-o orbname"		
orb to analyze (default ":")
.IP "-m match"			
match string on which srcnames are checked for latency
.IP "-r reject"			
reject string on which srcnames are checked for latency
.IP "-d tmpfiledir"		
where to place temporary files (default /tmp)
.IP "-n nailpath"		
path to the nail application, if not in regular path
.IP "-g graphvizpath"	
path to graphviz application, if not in regular path
.IP "-c checkinterval"	
how often to check status (default 30 min)

.IP "-t latencytimeout"	
number of minutes data must be delayed before we alert the user
(default 180 min)

.IP "-i mapinterval"		
send a current topology map every 'mapinterval' minutes. This value 
is granular to the value of 'checkinterval'

.IP "-l maplocation"		
if selected, it will create a GIF image of the current topology
for use on websites, etc.

.IP "-s emailsubject"	
Network name for subject in email alerts (default orbname)

.fi
.SH PARAMETER FILE
.nf
% pfecho orbtopo
dot                     /usr/bin/dot
registrydb              /home/rt/db/ucsd_orbregistry
web_tempdir_filesystem  /var/Web/tmp
web_tempdir_relative    tmp
%

.fi
.SH EXAMPLE
.nf
map_changes -o :roadnet -s "ROADNet" -x "tshansen@nlanr.net sfoley@ucsd.edu" -d topo
.fi
.SH LIBRARY
Requires antelope 4.5 or newer.
.SH "BUGS AND CAVEATS"
None so far.

By default these scripts install into /tmp. This may be overridden 
with the WEBDIR macro of the Makefile, e.g.
.nf

	make install WEBDIR=/var/Web

.fi	

The web temp directory in which image files are written needs
to be writable by the web server.
.SH AUTHOR
.nf
Todd Hansen
UCSD/ROADNet Project

Tweaked by Kent Lindquist, Lindquist Consulting
.fi
